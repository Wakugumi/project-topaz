import React, { useEffect, useState } from 'react';
import { useSearchParams } from 'react-router-dom';
import { Task } from '../types/Task';
import TaskService from '../services/TaskService';

interface Data {
	id: string;
	name: string;
	description: string;
}

const TaskDetailPage: React.FC = () => {
	const [searchParams] = useSearchParams();
	const [data, setData] = useState<Task | null>(null);
	const [error, setError] = useState<string | null>(null);

	const id = searchParams.get('id');

	useEffect(() => {
		if (!id) {
			setError('No ID provided in query parameters.');
			return;
		}

		TaskService.getTask(id)
			.then(result => {
				setData(result);
			})
			.catch(error => {
				setError(error);
			});

	}, [id]);

	if (error) {
		return <p className="text-danger">Error: {error}</p>;
	}

	if (!data) {
		return <p>Loading...</p>;
	}

	return (
		<div className="container-fluid">
			<div class="row">
				<h1 className="display-1">{data.id}</h1>
				<p><strong>Name:</strong> {data.title}</p>
				<p><strong>Deadline:</strong> {data.deadline}</p>
			</div>
		</div>
	);
};

export default TaskDetailPage;

